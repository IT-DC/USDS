// This file must be autogenerated

#ifndef USDS_DESERIALIZER
#define USDS_DESERIALIZER

#include <string.h>

#include "ticketSales.h"

// All types for getCurentRecordType()
#ifndef USDS_TYPE_TICKET_SALES
#define USDS_TYPE_TICKET_SALES 1
#endif

class UsdsDeserializer
{
public:
	UsdsDeserializer();
	~UsdsDeserializer();

	// Settings
	// Set for binary
	int setUsdsVersion(int major, int minor);
	int setDictionaryVersion(int major, int minor);
	// Get from binary (deserialization)
	int getUsdsVersion(int* major, int* minor);
	int getDictionaryVersion(int* major, int* minor);
	int getBinaryInfo(bool* head, bool* dictionary, bool* body, bool* index);

	// Deserialization
	int setBinary(unsigned char* data, int data_size);
	int findFirstAndInit(TicketSales* data);
	int findNextAndInit(TicketSales* data);
	int findFirstAndCreate(TicketSales** data);
	int findNextAndCreate(TicketSales** data);

	int clean();

private:
	// settings
	unsigned char usds_major;
	unsigned char usds_minor;
	unsigned char dictionary_major;
	unsigned char dictionary_minor;
	int full_dictionary_version;

	// Binary info
	bool head_included;
	bool dictionary_included;

	// for binary
	int binarySize;

	unsigned char* usds_buff;
	unsigned char* buff_last_pos;		// It is a position after last valid position in the Buffer. The Buffer size is buff_last_pos - usds_buff
	unsigned char* buff_current_pos;	// Last unread position in the Buffer. The document size is buff_current_pos - usds_buff
	unsigned char* buff_body_pos;		// The first byte of body, after tag 'B'
	unsigned char* buff_body_last_pos;	// The last body position - tag 0

	inline int getVarint(int* value);
	inline void getLEInt(int*value);
	inline void setLETimestamp64(time_t* value);
	inline void setLEDouble(double* value);
	inline int setStringUTF8NoConvert(char* value, int max_size);
	inline void setBool(bool* value);

};


#endif